<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .outBox{
            /* border: 1px solid #00f; */
            width: 200px;
            height: 200px;
            position: relative;
            overflow: hidden;
        }
     
        .inBox{
            position: absolute;
            /* border: 1px solid #000; */
            width: 1000px;
            height: 200px;
            display: flex;
            align-items: center;
            left: 0;
        }
        span{
            flex: 1;
            text-align: center;
        }

    </style>
</head>
<body>
    <div class="outBox">
        <div class="inBox">
            <span>1111</span>
            <span>2222</span>
            <span>3333</span>
            <span>4444</span>
            <span>1111</span>
        </div>
    </div>
    <img src="http://img5.imgtn.bdimg.com/it/u=1229616659,2735492520&fm=26&gp=0.jpg" id='img'/>
</body>
<script>
    // let inBox = document.querySelector('.inBox') ;
    // let allSpan = document.getElementsByTagName('span');
    // let x = 0;
    // setInterval(()=>{
    //     if(x == 800){
    //         x = 0;
    //     }
    //     x += 200;
    //     inBox.style.left = -x + 'px'
    //     inBox.style.transition = 'all 1s linear 0s';
    //     if(x == 800){
    //         setTimeout(() => {
    //             inBox.style.left = 0 + 'px'
    //             inBox.style.transition = 'none';
    //         }, 1000);
    //     }
    // }, 3000)
    //  ---
    // let p = new Promise((res,rej) => {
    //     setTimeout(() => {
    //         let data = {
    //             code: 200,
    //             msg: '登录成功'
    //         }
    //         res(data)
    //     })
    // })
    // p.then((data) => console.log(data.msg))

    // function Promise2(func){
    //     this.state = 'pending';
    //     this.value = undefined;
    //     this.reason = undefined;
    //     this.sucessF = [];
    //     this.errorF = [];
    //     let _this = this;
    //     func(resolved,rejected)
    //     function resolved(val){
    //         if (_this.state === 'pending') {
    //             _this.value = val;
    //             _this.sucessF.forEach(fun => fun(val))
    //             _this.state = 'resolved'
    //         }
    //     }
    //     function rejected(rea){
    //         console.log(2,rea,_this.state)
    //         if (_this.state === 'pending') {
    //             _this.reason = rea;
    //             _this.errorF.forEach(fun => fun(rea))
    //             _this.state = 'rejected'
    //         }
    //     }
    // }
    // Promise2.prototype.then = function (onF, onR) {
    //     console.log(1)
    //     if (this.state === 'pending') {
    //         if(typeof onF === 'function'){
    //             this.sucessF.push(onF)
    //         }
    //         if(typeof onR === 'function'){
    //             this.errorF.push(onR)
    //         }
    //     }
    //     // if (this.resolved === 'resolved') {
    //     //     onF(this.value)
    //     // }
    //     // if (this.resolved === 'rejected') {
    //     //     onR(this.reason)
    //     // }
    // }
    // let p = new Promise((res,rej) => {
    //     setTimeout(() => {
    //         let data = {
    //             code: 200,
    //             msg: '登录xx'
    //         }
    //         res(data)
    //     },1000)
    // })
    // p.then(
    //     (data) => {
    //         console.log(data.msg)
    //         return new Promise((res) => {
    //             setTimeout(() => {
    //                 res(123)    
    //             },1000)
    //         })
    //     }
    // ).then((data)=>{
    //     console.log(data)
    // // })
    // let arr = [1,2,3,4,4,1]
    // let newArr = arr.reduce((pre,cur)=>{
    //     console.log(pre, cur)
    //     // if(!pre.includes(cur)){
    //     //     return pre.concat(cur)
    //     // }else{
    //     //     return pre
    //     // }
    //     return pre.concat(cur*2)
    // },[])
    // console.log(newArr);// [1, 2, 3, 4]
    // let arr = [9,2,3,4,5];
    // // let arr2 = arr.map(item => item * 2);
    // // for(let key in arr){
    // //     arr[key] = arr[key] * 2
    // // }
    // // for(let v of arr){
    // //     v*=2
    // // }
    // let arr2 = [];
    // arr.reduce((pre,item)=>{
    //     console.log(pre,item)
    //     // item = item *
    //     arr2.push(item*2)
    //     return pre + item
    // },arr2)

    // console.log(arr2,'x')
    // console.log
    // window.onload = () => {
    //     console.log(11)
    // }
    // document.querySelector('#img').onload = () => {
    //     console.log(333)
    // }
    // function deepCopy(src){
    //     const type = Object.prototype.toString.call(src);
    //     if (type === '[object Object]' || type === '[object Array]') {
    //         const constructor = src.constructor;
    //         let data = new constructor();
    //         for(let key in src){
    //             data[key] = deepCopy(src[key])
    //         } 
    //         return data
    //     } else {
    //         return src
    //     }
    // }
    // let obj = {a: 1};
    // let obj2 = deepCopy(obj);
    // obj.a = 33;
    // console.log(obj,obj2)
    

    // let src = 'aacbd';
    // console.log(src.replace(/b/g,'').replace(/(ac)/,''),'x')

    // let aa = 'aabcd' //-> aacd -> ad -> 'ad'
    // console.log(aa.replace(/b/g,'').replace(/(ac)/,''),'x')

    // let aa = 'aaabbccc' // -> aaaccc -> aacc -> ac -> ''
    // console.log(aa.replace(/b/g,'').replace(/(ac)/,'').replace(/(ac)/,''),'x')

    // function bacReg(str){
    //     const reg = /(ac)/g;
    //     let data = 'ac'.replace(/b/g,'').replace(/(ac)/g,'');
    //     return reg.test(data) ? bacReg(str) : data ;
    // }

    // console.log( bacReg('aaabbccc'),'xx')
    // let p = new Promise((res,rej) => {
    //     fetch(
    //         'https://douban.uieee.com/v2/movie/top250'
    //     ).then(
    //         res => res.json()
    //     ).then(
    //         data => res(data)
    //     )
    // })
    // p.then((data)=>{
    //     console.log(data)
    // })

    function Promise2(perform){
        this.state = 'pending';
        this.secessValue = undefined;
        this.errorValue = undefined;
        this.secessFun = [];
        this.errorFun = [];
        
        let _this = this;
        perform(res,rej)
        function res(val){
            if (_this.state === 'pending' && typeof res === 'function') { 
                _this.secessValue = val;
                _this.secessFun.forEach(fun => fun(val));
                _this.state = 'resolved'
            }
        }
        function rej(val){
            if (_this.state === 'pending' && typeof rej === 'function') { 
                _this.errorValue = val;
                _this.errorFun.forEach(fun => fun(val));
                _this.state = 'rejected'
            }
        }
    }
    Promise2.prototype.then = function(secessF,errorF){
        if(this.state === 'pending'){
            this.secessFun.push(secessF)
            this.errorFun.push(errorF)
        }
        if (this.state === 'resolved') {
            secessF(this.secessValue)
        }
        if (this.state === 'rejected') {
            secessF(this.errorValue)
        }
    }
    let p = new Promise2((res,rej) => {
        fetch(
            'https://douban.uieee.com/v2/movie/top250'
        ).then(
            res => res.json()
        ).then(
            data => res(data)
        )
    })
    p.then((data)=>{
        console.log(data)
    },()=>{
        console.log('x')
    })
</script>
</html>